(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1dfc9c8e"],{"152a":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"orgPick-box"},[a("el-input",{attrs:{size:t.size,readonly:"",value:t.showTitle,placeholder:"请选择"},on:{focus:function(e){t.dialogVisible=!0}}}),a("el-dialog",{staticClass:"custom-dialog",attrs:{"append-to-body":"","close-on-click-modal":!1,title:"选择机构",visible:t.dialogVisible,width:"1000px"},on:{close:function(e){t.dialogVisible=!1}}},[a("div",{staticClass:"dialog-hd",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"title-ico ion",domProps:{innerHTML:t._s("&#xe680;")}}),t._v("选择学校 ")]),a("div",{staticClass:"flex-row orgPicker"},[a("div",{staticClass:"_side"},[a("div",{staticClass:"_keyword"},[a("el-input",{attrs:{placeholder:"学校名称搜索",maxlength:100,size:"medium"},model:{value:t.queryParam.name,callback:function(e){t.$set(t.queryParam,"name","string"===typeof e?e.trim():e)},expression:"queryParam.name"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(e){return t.fetchSchool(!0)}},slot:"append"})],1)],1),a("el-tree",{ref:"tree",attrs:{data:t.list,"node-key":"id",props:t.defaultProps,"default-expand-all":"","expand-on-click-node":!1,"visible-arrow":""},on:{"node-click":t.handleNodeClick}})],1),a("div",{staticClass:"_list flex-col flex-1 scrollbar"},[a("el-table",{staticClass:"flex-1",attrs:{height:"100%",data:t.schoolList,"highlight-current-row":""},on:{"current-change":t.handleCheckSchool}},[a("el-table-column",{attrs:{prop:"name",label:"名称","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"所属联盟","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.fullName&&e.row.fullName.split("/")[e.row.fullName.split("/").length-2])+" ")]}}])}),a("el-table-column",{attrs:{prop:"contacts",label:"负责人","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"contactsTel",label:"联系电话","show-overflow-tooltip":""}})],1),a("Pagination",{staticClass:"page-box",attrs:{"page-size":t.queryParam.pageSize,"current-page":t.queryParam.p,"total-count":t.totalCount,"total-page":t.totalPage},on:{"current-change":t.handleCurrentChange}})],1)]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"medium",type:"primary"},on:{click:t.submit}},[t._v("确 定")]),a("el-button",{attrs:{size:"medium"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")])],1)])],1)},i=[],l=a("c7b2"),n=function(t){return l["c"].get("/org/leagues",{params:t})},s=function(t){return l["c"].get("/org/school/s",{params:t})},c={model:{prop:"value",event:"change"},props:{value:{type:Number,required:!1},adapter:{type:Function,required:!1,default:function(){return function(t){return t}}},targetType:{type:Number,required:!1,default:0},size:{type:String,required:!1,default:"small"}},data:function(){return{loading:!1,dialogVisible:!1,list:[],defaultProps:{children:"children",label:"name"},checkedNode:{},queryParam:{pageSize:10,p:1,name:null,pid:null},schoolList:[],totalCount:0,totalPage:0}},computed:{showTitle:function(){return this.adapter(this.value,this.checkedNode)}},methods:{handleCheckSchool:function(t){t&&(this.checkedNode=t)},handleCurrentChange:function(t){this.queryParam.p=t,this.fetchSchool()},fetchData:function(){var t=this;this.loading=!0,n().then((function(e){t.loading=!1;var a=e.data.data;a&&(t.list=l["e"].buildTree(a),t.queryParam.pid=a[0].id,t.fetchSchool(!0))})).catch((function(){t.loading=!1}))},fetchSchool:function(t){var e=this;t&&(this.queryParam.p=1),this.loading=!0,s(Object.assign({pid:this.checkedNode&&this.checkedNode.id||null},this.queryParam)).then((function(t){e.loading=!1;var a=t.data.data;a&&(e.schoolList=a.list,e.totalCount=a.totalCount,e.totalPage=a.totalPage)})).catch((function(){e.loading=!1}))},handleNodeClick:function(t){this.checkedNode=t,this.queryParam.pid=t.id,this.fetchSchool(!0)},submit:function(){if((1===this.targetType||2===this.targetType)&&this.targetType!==this.checkedNode.type){var t={1:"联盟",2:"学校"}[this.targetType];return this.$message.warning("请选择".concat(t,"！"))}this.checkedNode&&this.checkedNode.id&&this.$emit("change",this.checkedNode.id),this.dialogVisible=!1}},created:function(){this.fetchData()}},r=c,d=(a("d5c9"),a("2877")),u=Object(d["a"])(r,o,i,!1,null,"d4305382",null);e["default"]=u.exports},d5c9:function(t,e,a){"use strict";a("ee8b")},ee8b:function(t,e,a){}}]);