(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-415daf8d"],{"09b9":function(t,e,a){},2127:function(t,e,a){"use strict";a.r(e),a.d(e,"list",(function(){return n})),a.d(e,"detail",(function(){return o})),a.d(e,"add",(function(){return i})),a.d(e,"edit",(function(){return c})),a.d(e,"remove",(function(){return s}));var r=a("c7b2"),n=function(t){return r["a"].get("/role/s",{params:t})},o=function(t){return r["a"].get("/role",{params:t})},i=function(t){return r["a"].post("/role",t)},c=function(t){return r["a"].put("/role",t)},s=function(t){return r["a"].delete("/role",{params:t})}},"400a":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[a("ToolBar",[a("el-button",{directives:[{name:"auth",rawName:"v-auth",value:t.account.add,expression:"account.add"}],attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:function(e){t.dialogVisible=!0}}},[t._v("添加")])],1),a("el-table",{attrs:{data:t.list}},[a("el-table-column",{attrs:{prop:"accountNumber",label:"账号",align:"center"}}),a("el-table-column",{attrs:{prop:"accountName",label:"用户名",align:"center"}}),a("el-table-column",{attrs:{prop:"roleName",label:"角色",align:"center"}}),a("el-table-column",{attrs:{label:"状态",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.state?[a("span",{staticStyle:{color:"#13ce66"}},[t._v("已启用")])]:[a("span",{staticStyle:{color:"#ff4949"}},[t._v("已禁用")])]]}}])}),a("el-table-column",{attrs:{label:"操作",width:"300",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{directives:[{name:"auth",rawName:"v-auth",value:t.account.edit,expression:"account.edit"}],attrs:{size:"mini"},on:{click:function(a){return t.edit(e.row)}}},[t._v("编辑")]),a("el-button",{directives:[{name:"auth",rawName:"v-auth",value:t.account.resetPassword,expression:"account.resetPassword"}],attrs:{size:"mini",type:"warning",plain:""},on:{click:function(a){return t.resetPassword(e.row)}}},[t._v("重置密码")]),a("el-button",{directives:[{name:"auth",rawName:"v-auth",value:t.account.remove,expression:"account.remove"}],attrs:{size:"mini",type:"danger",plain:""},on:{click:function(a){return t.remove(e.row)}}},[t._v("删除")])]}}])})],1),a("Pagination",{attrs:{"page-size":t.queryParam.pageSize,"current-page":t.queryParam.p,"total-count":t.totalCount,"total-page":t.totalPage},on:{"current-change":t.handleCurrentChange}}),a("el-dialog",{staticClass:"userEditDialog",attrs:{"close-on-click-modal":!1,title:"账号信息",visible:t.dialogVisible,width:"600px"},on:{close:t.handleCloseDialog}},[a("el-form",{ref:"editForm",attrs:{size:"small",rules:t.rules,model:t.editForm,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"头像",prop:"avatar"}},[a("uploader",{staticClass:"upload_avatar",attrs:{accept:"t-image",value:t.editForm.avatar?[{url:t.editForm.avatar}]:[],imgCrop:"","show-file-list":!1,"on-success":function(e){t.$set(t.editForm,"avatar",e.url)}}},[t.editForm.avatar?a("img",{attrs:{src:t.editForm.avatar,alt:""}}):a("span",[t._v("上传头像")])])],1),a("el-form-item",{attrs:{label:"账号",prop:"accountNumber"}},[a("el-input",{attrs:{maxlength:100},model:{value:t.editForm.accountNumber,callback:function(e){t.$set(t.editForm,"accountNumber","string"===typeof e?e.trim():e)},expression:"editForm.accountNumber"}})],1),a("el-form-item",{attrs:{label:"用户名",prop:"accountName"}},[a("el-input",{attrs:{maxlength:100},model:{value:t.editForm.accountName,callback:function(e){t.$set(t.editForm,"accountName","string"===typeof e?e.trim():e)},expression:"editForm.accountName"}})],1),t.editForm.id?t._e():[a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("input-password",{attrs:{autocomplete:"off"},model:{value:t.editForm.password,callback:function(e){t.$set(t.editForm,"password",e)},expression:"editForm.password"}})],1),a("el-form-item",{attrs:{label:"确认密码",prop:"checkPass"}},[a("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:t.editForm.checkPass,callback:function(e){t.$set(t.editForm,"checkPass",e)},expression:"editForm.checkPass"}})],1)],a("el-form-item",{attrs:{label:"所属组织",prop:"orgId"}},[a("OrgPicker",{attrs:{adapter:t.orgAdapter},on:{change:function(e){return t.$refs.editForm.validateField("orgId")}},model:{value:t.editForm.orgId,callback:function(e){t.$set(t.editForm,"orgId",e)},expression:"editForm.orgId"}})],1),a("el-form-item",{attrs:{label:"角色"}},[a("DictSelect",{attrs:{request:t.requestRoles,labelKey:"name"},model:{value:t.editForm.roleId,callback:function(e){t.$set(t.editForm,"roleId",e)},expression:"editForm.roleId"}})],1),a("el-form-item",{attrs:{label:"状态"}},[a("el-switch",{attrs:{"active-text":"启用","inactive-text":"禁用","active-value":1,"inactive-value":0},model:{value:t.editForm.state,callback:function(e){t.$set(t.editForm,"state",e)},expression:"editForm.state"}})],1)],2),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("确 定")]),a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")])],1)],1)],1)},n=[],o=a("c7b2"),i=a("53ab"),c=a("2127"),s={components:{OrgPicker:function(t){return a.e("chunk-16391a27").then(function(){var e=[a("a268")];t.apply(null,e)}.bind(this)).catch(a.oe)}},data:function(){var t=this,e=function(e,a,r){a?(""!==t.editForm.checkPass&&t.$refs.editForm.validateField("checkPass"),r()):r(new Error("请输入密码"))},a=function(e,a,r){a?a!==t.editForm.password?r(new Error("两次输入密码不一致!")):r():r(new Error("请再次输入密码"))};return{account:i,dialogVisible:!1,loading:!1,list:[],editForm:{id:"",accountNumber:"",accountName:"",password:"",roles:[],state:1},queryParam:{pageSize:10,p:1},totalCount:0,totalPage:0,rules:{accountNumber:[{required:!0,message:"请输入账号",trigger:"blur"}],accountName:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{validator:e,trigger:"blur"}],checkPass:[{validator:a,trigger:"blur"}],orgId:[{required:!0,message:"请选择所属组织"}]},requestRoles:c["list"]}},methods:{orgAdapter:function(t,e){return e.name||this.editForm.belongOrgName||t},handleCurrentChange:function(t){this.queryParam.p=t,this.fetchData()},resetPassword:function(t){var e=this;if(!t)return null;this.$confirm("确定重置账号 ".concat(t.accountNumber," 的密码?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.loading=!0,i["resetPassword"]({id:t.id}).then((function(t){t.data.password?e.$clipboard(t.data.password).then((function(){e.$alert("新密码已复制到剪贴板，请保管好新密码：<code>".concat(t.data.password,"</code>"),{confirmButtonText:"我知道了",dangerouslyUseHTMLString:!0}).then((function(){e.fetchData()}))})).catch((function(){e.$alert("密码已重置，请牢记新密码：<code>".concat(t.data.password,"</code>"),{confirmButtonText:"我知道了",dangerouslyUseHTMLString:!0}).then((function(){e.fetchData()}))})):e.$message.warning("操作失败，请重试")})).catch((function(){e.loading=!1}))}))},edit:function(t){var e=Object.assign({},t);e.roles=Array.isArray(e.roles)?e.roles.map((function(t){return t.roleId})):[],this.editForm=e,this.dialogVisible=!0},save:function(){var t=this;this.$refs["editForm"].validate((function(e){if(e){t.loading=!0;var a=o["c"].deepcopy(t.editForm);t.handleCloseDialog();var r=a.id?i["edit"]:i["add"];r(a).then((function(){t.fetchData(),t.$message({message:"添加成功",type:"success"})})).catch((function(){t.loading=!1}))}}))},handleCloseDialog:function(){this.dialogVisible=!1,this.editForm={id:"",accountNumber:"",accountName:"",password:"",roles:[],state:1},this.$refs.editForm&&this.$refs.editForm.resetFields()},remove:function(t){var e=this;if(!t)return null;this.$confirm("是否删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.loading=!0,i["remove"]({id:t.id}).then((function(){e.fetchData(),e.$message({message:"删除成功",type:"success"})})).catch((function(){e.loading=!1}))}))},fetchData:function(t){var e=this;t&&(this.queryParam.p=1),this.loading=!0,i["list"](this.queryParam).then((function(t){e.loading=!1;var a=t.data;a&&(e.list=a.list,e.totalCount=a.totalCount,e.totalPage=a.totalPage)})).catch((function(){e.loading=!1}))}},created:function(){this.fetchData()}},l=s,u=(a("636c"),a("2877")),d=Object(u["a"])(l,r,n,!1,null,"5cd9f83e",null);e["default"]=d.exports},"53ab":function(t,e,a){"use strict";a.r(e),a.d(e,"list",(function(){return n})),a.d(e,"detail",(function(){return o})),a.d(e,"add",(function(){return i})),a.d(e,"edit",(function(){return c})),a.d(e,"remove",(function(){return s})),a.d(e,"resetPassword",(function(){return l}));var r=a("c7b2"),n=function(t){return r["a"].get("/account/s",{params:t})},o=function(t){return r["a"].get("/account",{params:t})},i=function(t){return r["a"].post("/account",t)},c=function(t){return r["a"].put("/account",t)},s=function(t){return r["a"].delete("/account",{params:t})},l=function(t){return r["a"].put("/account/reset",t)}},"636c":function(t,e,a){"use strict";a("09b9")}}]);