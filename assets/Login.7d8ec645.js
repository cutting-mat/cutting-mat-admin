import{n as s,l as o,S as n,e as l}from"./index.208c0d27.js";import"./ui.9b8b7178.js";var c=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"flex-row align-center justify-center loginPage"},[e("div",[e("h1",{staticClass:"main-title"},[t._v("\u5E73\u53F0\u540D\u79F0\u6587\u5B57\u5360\u4F4D\u7B26\u540E\u53F0\u7BA1\u7406\u7CFB\u7EDF")]),e("el-form",{ref:"validForm",staticClass:"login-form",attrs:{model:t.formData,rules:t.rules},nativeOn:{submit:function(a){return a.preventDefault(),t.login.apply(null,arguments)}}},[e("h2",{staticClass:"sub-title"},[e("span",{staticClass:"_text"},[t._v("\u8BF7\u767B\u5F55")])]),e("el-form-item",{attrs:{prop:"account"}},[e("el-input",{attrs:{autofocus:!0,placeholder:"\u8F93\u5165\u7528\u6237\u540D"},model:{value:t.formData.account,callback:function(a){t.$set(t.formData,"account",a)},expression:"formData.account"}})],1),e("el-form-item",{attrs:{prop:"password"}},[e("el-input",{attrs:{placeholder:"\u8F93\u5165\u5BC6\u7801",type:"password","show-password":""},model:{value:t.formData.password,callback:function(a){t.$set(t.formData,"password",a)},expression:"formData.password"}})],1),e("el-form-item",{attrs:{prop:"captcha"}},[e("InputCaptchaImage",{ref:"InputCaptchaImage"})],1),e("div",{staticClass:"flex-row align-center"},[e("div",{staticClass:"flex-1"}),e("el-link",{attrs:{type:"info"},on:{click:t.handleChangePw}},[t._v(" \u5FD8\u8BB0\u5BC6\u7801\uFF1F ")])],1),e("el-form-item",{staticClass:"submit-item"},[e("el-button",{staticClass:"submit-button",attrs:{"native-type":"submit",type:"primary",loading:t.loading}},[t._v("\u767B\u5F55")])],1),e("div",{staticClass:"flex-row"},[e("div",{staticClass:"flex-1"}),e("el-link",{attrs:{type:"primary"},on:{click:function(a){return t.$router.push({name:"\u6CE8\u518C"})}}},[t._v(" \u7ACB\u5373\u6CE8\u518C "),e("i",{staticClass:"el-icon-right"})])],1)],1),e("div",{staticClass:"footer-info"},[t._v(" @2022 \u7248\u6743\u6240\u6709 \u5360\u4F4D\u6587\u5B57 "),e("span",{staticClass:"_s"},[t._v("|")]),t._v(" Github\uFF1A "),e("el-link",{attrs:{type:"primary",href:"https://github.com/cutting-mat",target:"_blank"}},[t._v("cutting-mat")])],1)],1),e("auth",{ref:"auth",attrs:{types:["email","mobile"],command:"reset"}})],1)},f=[];const u={data(){return{loading:!1,formData:{account:"",password:"",captcha:""},rules:{account:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D",trigger:"blur"},{min:3,max:30,message:"\u957F\u5EA6\u5728 3 \u5230 30 \u4E2A\u5B57\u7B26",trigger:"blur"}],password:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801",trigger:"blur"},{min:6,max:30,message:"\u957F\u5EA6\u5728 6 \u5230 30 \u4E2A\u5B57\u7B26",trigger:"blur"}],captcha:[{validator:()=>new Promise((i,e)=>{this.formData.captcha?i():this.$refs.InputCaptchaImage.valid().then(a=>{console.log("then",a),this.formData.captcha=a,i()}).catch(a=>{console.log("catch",a),e(a)})}),trigger:[]}]}}},methods:{login(){if(this.loading)return null;this.loading=!0,this.$refs.validForm.validate(t=>{t?o(this.formData).then(i=>{i.status===200?(this.loading=!1,n(i.data),l.emit("login",()=>{this.$router.replace({path:this.$router.currentRoute.query.redirect||"/"})})):this.$message({message:"\u767B\u9646\u5931\u8D25",type:"warning"})}).catch(()=>{this.loading=!1}):this.loading=!1})},handleChangePw(){this.$refs.auth.auth().then(t=>{this.$router.push({name:"\u4FEE\u6539\u5BC6\u7801",query:{authCode:t}})})}}},r={};var m=s(u,c,f,!1,p,"79f40ef2",null,null);function p(t){for(let i in r)this[i]=r[i]}var h=function(){return m.exports}();export{h as default};
