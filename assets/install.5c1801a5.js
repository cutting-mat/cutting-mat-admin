import{b4 as le,R as Z,_ as z,J as te,B as L,bz as se,bL as ce,m as ue,aS as pe,aW as ge,C as he,F as W,i as ve,bm as X,o as de,a1 as fe,bM as ye,O as Y,bN as me,Z as V,w as Se,bO as j,l as q,aN as xe,aO as be,bP as T,b as Ce,bQ as Ge,c as _e,U as R,G as re,bB as De,H as Le,bC as Pe,aZ as Ie,b1 as Re,aV as Ae,bR as we,A as Oe,V as N}from"./variate.71f5ba4d.js";function Te(n,r){var e=le(r.get("padding")),t=r.getItemStyle(["color","opacity"]);return t.fill=r.get("backgroundColor"),n=new Z({shape:{x:n.x-e[3],y:n.y-e[0],width:n.width+e[1]+e[3],height:n.height+e[0]+e[2],r:r.get("borderRadius")},style:t,silent:!0,z2:-1}),n}var ke=function(n,r){if(r==="all")return{type:"all",title:n.getLocaleModel().get(["legend","selector","all"])};if(r==="inverse")return{type:"inverse",title:n.getLocaleModel().get(["legend","selector","inverse"])}},Be=function(n){z(r,n);function r(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=r.type,e.layoutMode={type:"box",ignoreSize:!0},e}return r.prototype.init=function(e,t,o){this.mergeDefaultAndTheme(e,o),e.selected=e.selected||{},this._updateSelector(e)},r.prototype.mergeOption=function(e,t){n.prototype.mergeOption.call(this,e,t),this._updateSelector(e)},r.prototype._updateSelector=function(e){var t=e.selector,o=this.ecModel;t===!0&&(t=e.selector=["all","inverse"]),te(t)&&L(t,function(i,l){W(i)&&(i={type:i}),t[l]=se(i,ke(o,i.type))})},r.prototype.optionUpdated=function(){this._updateData(this.ecModel);var e=this._data;if(e[0]&&this.get("selectedMode")==="single"){for(var t=!1,o=0;o<e.length;o++){var i=e[o].get("name");if(this.isSelected(i)){this.select(i),t=!0;break}}!t&&this.select(e[0].get("name"))}},r.prototype._updateData=function(e){var t=[],o=[];e.eachRawSeries(function(u){var v=u.name;o.push(v);var a;if(u.legendVisualProvider){var s=u.legendVisualProvider,d=s.getAllNames();e.isSeriesFiltered(u)||(o=o.concat(d)),d.length?t=t.concat(d):a=!0}else a=!0;a&&ce(u)&&t.push(u.name)}),this._availableNames=o;var i=this.get("data")||t,l=ue(i,function(u){return(W(u)||ve(u))&&(u={name:u}),new pe(u,this,this.ecModel)},this);this._data=l},r.prototype.getData=function(){return this._data},r.prototype.select=function(e){var t=this.option.selected,o=this.get("selectedMode");if(o==="single"){var i=this._data;L(i,function(l){t[l.get("name")]=!1})}t[e]=!0},r.prototype.unSelect=function(e){this.get("selectedMode")!=="single"&&(this.option.selected[e]=!1)},r.prototype.toggleSelected=function(e){var t=this.option.selected;t.hasOwnProperty(e)||(t[e]=!0),this[t[e]?"unSelect":"select"](e)},r.prototype.allSelect=function(){var e=this._data,t=this.option.selected;L(e,function(o){t[o.get("name",!0)]=!0})},r.prototype.inverseSelect=function(){var e=this._data,t=this.option.selected;L(e,function(o){var i=o.get("name",!0);t.hasOwnProperty(i)||(t[i]=!0),t[i]=!t[i]})},r.prototype.isSelected=function(e){var t=this.option.selected;return!(t.hasOwnProperty(e)&&!t[e])&&ge(this._availableNames,e)>=0},r.prototype.getOrient=function(){return this.get("orient")==="vertical"?{index:1,name:"vertical"}:{index:0,name:"horizontal"}},r.type="legend.plain",r.dependencies=["series"],r.defaultOption={z:4,show:!0,orient:"horizontal",left:"center",top:0,align:"auto",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemGap:10,itemWidth:25,itemHeight:14,symbolRotate:"inherit",symbolKeepAspect:!0,inactiveColor:"#ccc",inactiveBorderColor:"#ccc",inactiveBorderWidth:"auto",itemStyle:{color:"inherit",opacity:"inherit",borderColor:"inherit",borderWidth:"auto",borderCap:"inherit",borderJoin:"inherit",borderDashOffset:"inherit",borderMiterLimit:"inherit"},lineStyle:{width:"auto",color:"inherit",inactiveColor:"#ccc",inactiveWidth:2,opacity:"inherit",type:"inherit",cap:"inherit",join:"inherit",dashOffset:"inherit",miterLimit:"inherit"},textStyle:{color:"#333"},selectedMode:!0,selector:!1,selectorLabel:{show:!0,borderRadius:10,padding:[3,5,3,5],fontSize:12,fontFamily:"sans-serif",color:"#666",borderWidth:1,borderColor:"#666"},emphasis:{selectorLabel:{show:!0,color:"#eee",backgroundColor:"#666"}},selectorPosition:"auto",selectorItemGap:7,selectorButtonGap:10,tooltip:{show:!1}},r}(he);const $=Be;var I=R,E=L,B=re,We=function(n){z(r,n);function r(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=r.type,e.newlineDisabled=!1,e}return r.prototype.init=function(){this.group.add(this._contentGroup=new B),this.group.add(this._selectorGroup=new B),this._isFirstRender=!0},r.prototype.getContentGroup=function(){return this._contentGroup},r.prototype.getSelectorGroup=function(){return this._selectorGroup},r.prototype.render=function(e,t,o){var i=this._isFirstRender;if(this._isFirstRender=!1,this.resetInner(),!!e.get("show",!0)){var l=e.get("align"),u=e.get("orient");(!l||l==="auto")&&(l=e.get("left")==="right"&&u==="vertical"?"right":"left");var v=e.get("selector",!0),a=e.get("selectorPosition",!0);v&&(!a||a==="auto")&&(a=u==="horizontal"?"end":"start"),this.renderInner(l,e,t,o,v,u,a);var s=e.getBoxLayoutParams(),d={width:o.getWidth(),height:o.getHeight()},p=e.get("padding"),g=X(s,d,p),h=this.layoutInner(e,l,g,i,v,a),c=X(de({width:h.width,height:h.height},s),d,p);this.group.x=c.x-h.x,this.group.y=c.y-h.y,this.group.markRedraw(),this.group.add(this._backgroundEl=Te(h,e))}},r.prototype.resetInner=function(){this.getContentGroup().removeAll(),this._backgroundEl&&this.group.remove(this._backgroundEl),this.getSelectorGroup().removeAll()},r.prototype.renderInner=function(e,t,o,i,l,u,v){var a=this.getContentGroup(),s=fe(),d=t.get("selectedMode"),p=[];o.eachRawSeries(function(g){!g.get("legendHoverLink")&&p.push(g.id)}),E(t.getData(),function(g,h){var c=g.get("name");if(!this.newlineDisabled&&(c===""||c===`
`)){var m=new B;m.newline=!0,a.add(m);return}var f=o.getSeriesByName(c)[0];if(!s.get(c))if(f){var y=f.getData(),S=y.getVisual("legendLineStyle")||{},G=y.getVisual("legendIcon"),x=y.getVisual("style"),b=this._createItem(f,c,h,g,t,e,S,x,G,d,i);b.on("click",I(Q,c,null,i,p)).on("mouseover",I(K,f.name,null,i,p)).on("mouseout",I(U,f.name,null,i,p)),s.set(c,!0)}else o.eachRawSeries(function(C){if(!s.get(c)&&C.legendVisualProvider){var _=C.legendVisualProvider;if(!_.containName(c))return;var k=_.indexOfName(c),D=_.getItemVisual(k,"style"),A=_.getItemVisual(k,"legendIcon"),P=ye(D.fill);P&&P[3]===0&&(P[3]=.2,D=Y(Y({},D),{fill:me(P,"rgba")}));var w=this._createItem(C,c,h,g,t,e,{},D,A,d,i);w.on("click",I(Q,null,c,i,p)).on("mouseover",I(K,null,c,i,p)).on("mouseout",I(U,null,c,i,p)),s.set(c,!0)}},this)},this),l&&this._createSelector(l,t,i,u,v)},r.prototype._createSelector=function(e,t,o,i,l){var u=this.getSelectorGroup();E(e,function(a){var s=a.type,d=new V({style:{x:0,y:0,align:"center",verticalAlign:"middle"},onclick:function(){o.dispatchAction({type:s==="all"?"legendAllSelect":"legendInverseSelect"})}});u.add(d);var p=t.getModel("selectorLabel"),g=t.getModel(["emphasis","selectorLabel"]);Se(d,{normal:p,emphasis:g},{defaultText:a.title}),j(d)})},r.prototype._createItem=function(e,t,o,i,l,u,v,a,s,d,p){var g=e.visualDrawType,h=l.get("itemWidth"),c=l.get("itemHeight"),m=l.isSelected(t),f=i.get("symbolRotate"),y=i.get("symbolKeepAspect"),S=i.get("icon");s=S||s||"roundRect";var G=ze(s,i,v,a,g,m,p),x=new B,b=i.getModel("textStyle");if(q(e.getLegendIcon)&&(!S||S==="inherit"))x.add(e.getLegendIcon({itemWidth:h,itemHeight:c,icon:s,iconRotate:f,itemStyle:G.itemStyle,lineStyle:G.lineStyle,symbolKeepAspect:y}));else{var C=S==="inherit"&&e.getData().getVisual("symbol")?f==="inherit"?e.getData().getVisual("symbolRotate"):f:0;x.add(Fe({itemWidth:h,itemHeight:c,icon:s,iconRotate:C,itemStyle:G.itemStyle,lineStyle:G.lineStyle,symbolKeepAspect:y}))}var _=u==="left"?h+5:-5,k=u,D=l.get("formatter"),A=t;W(D)&&D?A=D.replace("{name}",t!=null?t:""):q(D)&&(A=D(t));var P=i.get("inactiveColor");x.add(new V({style:xe(b,{text:A,x:_,y:c/2,fill:m?b.getTextColor():P,align:k,verticalAlign:"middle"})}));var w=new Z({shape:x.getBoundingRect(),invisible:!0}),J=i.getModel("tooltip");return J.get("show")&&be({el:w,componentModel:l,itemName:t,itemTooltipOption:J.option}),x.add(w),x.eachChild(function(oe){oe.silent=!0}),w.silent=!d,this.getContentGroup().add(x),j(x),x.__legendDataIndex=o,x},r.prototype.layoutInner=function(e,t,o,i,l,u){var v=this.getContentGroup(),a=this.getSelectorGroup();T(e.get("orient"),v,e.get("itemGap"),o.width,o.height);var s=v.getBoundingRect(),d=[-s.x,-s.y];if(a.markRedraw(),v.markRedraw(),l){T("horizontal",a,e.get("selectorItemGap",!0));var p=a.getBoundingRect(),g=[-p.x,-p.y],h=e.get("selectorButtonGap",!0),c=e.getOrient().index,m=c===0?"width":"height",f=c===0?"height":"width",y=c===0?"y":"x";u==="end"?g[c]+=s[m]+h:d[c]+=p[m]+h,g[1-c]+=s[f]/2-p[f]/2,a.x=g[0],a.y=g[1],v.x=d[0],v.y=d[1];var S={x:0,y:0};return S[m]=s[m]+h+p[m],S[f]=Math.max(s[f],p[f]),S[y]=Math.min(0,p[y]+g[1-c]),S}else return v.x=d[0],v.y=d[1],this.group.getBoundingRect()},r.prototype.remove=function(){this.getContentGroup().removeAll(),this._isFirstRender=!0},r.type="legend.plain",r}(Ce);function ze(n,r,e,t,o,i,l){function u(m,f){m.lineWidth==="auto"&&(m.lineWidth=f.lineWidth>0?2:0),E(m,function(y,S){m[S]==="inherit"&&(m[S]=f[S])})}var v=r.getModel("itemStyle"),a=v.getItemStyle(),s=n.lastIndexOf("empty",0)===0?"fill":"stroke",d=v.getShallow("decal");a.decal=!d||d==="inherit"?t.decal:Ge(d,l),a.fill==="inherit"&&(a.fill=t[o]),a.stroke==="inherit"&&(a.stroke=t[s]),a.opacity==="inherit"&&(a.opacity=(o==="fill"?t:e).opacity),u(a,t);var p=r.getModel("lineStyle"),g=p.getLineStyle();if(u(g,e),a.fill==="auto"&&(a.fill=t.fill),a.stroke==="auto"&&(a.stroke=t.fill),g.stroke==="auto"&&(g.stroke=t.fill),!i){var h=r.get("inactiveBorderWidth"),c=a[s];a.lineWidth=h==="auto"?t.lineWidth>0&&c?2:0:a.lineWidth,a.fill=r.get("inactiveColor"),a.stroke=r.get("inactiveBorderColor"),g.stroke=p.get("inactiveColor"),g.lineWidth=p.get("inactiveWidth")}return{itemStyle:a,lineStyle:g}}function Fe(n){var r=n.icon||"roundRect",e=_e(r,0,0,n.itemWidth,n.itemHeight,n.itemStyle.fill,n.symbolKeepAspect);return e.setStyle(n.itemStyle),e.rotation=(n.iconRotate||0)*Math.PI/180,e.setOrigin([n.itemWidth/2,n.itemHeight/2]),r.indexOf("empty")>-1&&(e.style.stroke=e.style.fill,e.style.fill="#fff",e.style.lineWidth=2),e}function Q(n,r,e,t){U(n,r,e,t),e.dispatchAction({type:"legendToggleSelect",name:n!=null?n:r}),K(n,r,e,t)}function ne(n){for(var r=n.getZr().storage.getDisplayList(),e,t=0,o=r.length;t<o&&!(e=r[t].states.emphasis);)t++;return e&&e.hoverLayer}function K(n,r,e,t){ne(e)||e.dispatchAction({type:"highlight",seriesName:n,name:r,excludeSeriesId:t})}function U(n,r,e,t){ne(e)||e.dispatchAction({type:"downplay",seriesName:n,name:r,excludeSeriesId:t})}const ie=We;function He(n){var r=n.findComponents({mainType:"legend"});r&&r.length&&n.filterSeries(function(e){for(var t=0;t<r.length;t++)if(!r[t].isSelected(e.name))return!1;return!0})}function O(n,r,e){var t={},o=n==="toggleSelected",i;return e.eachComponent("legend",function(l){o&&i!=null?l[i?"select":"unSelect"](r.name):n==="allSelect"||n==="inverseSelect"?l[n]():(l[n](r.name),i=l.isSelected(r.name));var u=l.getData();L(u,function(v){var a=v.get("name");if(!(a===`
`||a==="")){var s=l.isSelected(a);t.hasOwnProperty(a)?t[a]=t[a]&&s:t[a]=s}})}),n==="allSelect"||n==="inverseSelect"?{selected:t}:{name:r.name,selected:t}}function Ve(n){n.registerAction("legendToggleSelect","legendselectchanged",R(O,"toggleSelected")),n.registerAction("legendAllSelect","legendselectall",R(O,"allSelect")),n.registerAction("legendInverseSelect","legendinverseselect",R(O,"inverseSelect")),n.registerAction("legendSelect","legendselected",R(O,"select")),n.registerAction("legendUnSelect","legendunselected",R(O,"unSelect"))}function ae(n){n.registerComponentModel($),n.registerComponentView(ie),n.registerProcessor(n.PRIORITY.PROCESSOR.SERIES_FILTER,He),n.registerSubTypeDefaulter("legend",function(){return"plain"}),Ve(n)}var Ne=function(n){z(r,n);function r(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=r.type,e}return r.prototype.setScrollDataIndex=function(e){this.option.scrollDataIndex=e},r.prototype.init=function(e,t,o){var i=De(e);n.prototype.init.call(this,e,t,o),M(this,e,i)},r.prototype.mergeOption=function(e,t){n.prototype.mergeOption.call(this,e,t),M(this,this.option,e)},r.type="legend.scroll",r.defaultOption=Le($.defaultOption,{scrollDataIndex:0,pageButtonItemGap:5,pageButtonGap:null,pageButtonPosition:"end",pageFormatter:"{current}/{total}",pageIcons:{horizontal:["M0,0L12,-10L12,10z","M0,0L-12,-10L-12,10z"],vertical:["M0,0L20,0L10,-20z","M0,0L20,0L10,20z"]},pageIconColor:"#2f4554",pageIconInactiveColor:"#aaa",pageIconSize:15,pageTextStyle:{color:"#333"},animationDurationUpdate:800}),r}($);function M(n,r,e){var t=n.getOrient(),o=[1,1];o[t.index]=0,Pe(r,e,{type:"box",ignoreSize:!!o})}const $e=Ne;var ee=re,F=["width","height"],H=["x","y"],Ee=function(n){z(r,n);function r(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=r.type,e.newlineDisabled=!0,e._currentIndex=0,e}return r.prototype.init=function(){n.prototype.init.call(this),this.group.add(this._containerGroup=new ee),this._containerGroup.add(this.getContentGroup()),this.group.add(this._controllerGroup=new ee)},r.prototype.resetInner=function(){n.prototype.resetInner.call(this),this._controllerGroup.removeAll(),this._containerGroup.removeClipPath(),this._containerGroup.__rectSize=null},r.prototype.renderInner=function(e,t,o,i,l,u,v){var a=this;n.prototype.renderInner.call(this,e,t,o,i,l,u,v);var s=this._controllerGroup,d=t.get("pageIconSize",!0),p=te(d)?d:[d,d];h("pagePrev",0);var g=t.getModel("pageTextStyle");s.add(new V({name:"pageText",style:{text:"xx/xx",fill:g.getTextColor(),font:g.getFont(),verticalAlign:"middle",align:"center"},silent:!0})),h("pageNext",1);function h(c,m){var f=c+"DataIndex",y=Ie(t.get("pageIcons",!0)[t.getOrient().name][m],{onclick:Re(a._pageGo,a,f,t,i)},{x:-p[0]/2,y:-p[1]/2,width:p[0],height:p[1]});y.name=c,s.add(y)}},r.prototype.layoutInner=function(e,t,o,i,l,u){var v=this.getSelectorGroup(),a=e.getOrient().index,s=F[a],d=H[a],p=F[1-a],g=H[1-a];l&&T("horizontal",v,e.get("selectorItemGap",!0));var h=e.get("selectorButtonGap",!0),c=v.getBoundingRect(),m=[-c.x,-c.y],f=Ae(o);l&&(f[s]=o[s]-c[s]-h);var y=this._layoutContentAndController(e,i,f,a,s,p,g,d);if(l){if(u==="end")m[a]+=y[s]+h;else{var S=c[s]+h;m[a]-=S,y[d]-=S}y[s]+=c[s]+h,m[1-a]+=y[g]+y[p]/2-c[p]/2,y[p]=Math.max(y[p],c[p]),y[g]=Math.min(y[g],c[g]+m[1-a]),v.x=m[0],v.y=m[1],v.markRedraw()}return y},r.prototype._layoutContentAndController=function(e,t,o,i,l,u,v,a){var s=this.getContentGroup(),d=this._containerGroup,p=this._controllerGroup;T(e.get("orient"),s,e.get("itemGap"),i?o.width:null,i?null:o.height),T("horizontal",p,e.get("pageButtonItemGap",!0));var g=s.getBoundingRect(),h=p.getBoundingRect(),c=this._showController=g[l]>o[l],m=[-g.x,-g.y];t||(m[i]=s[a]);var f=[0,0],y=[-h.x,-h.y],S=we(e.get("pageButtonGap",!0),e.get("itemGap",!0));if(c){var G=e.get("pageButtonPosition",!0);G==="end"?y[i]+=o[l]-h[l]:f[i]+=h[l]+S}y[1-i]+=g[u]/2-h[u]/2,s.setPosition(m),d.setPosition(f),p.setPosition(y);var x={x:0,y:0};if(x[l]=c?o[l]:g[l],x[u]=Math.max(g[u],h[u]),x[v]=Math.min(0,h[v]+y[1-i]),d.__rectSize=o[l],c){var b={x:0,y:0};b[l]=Math.max(o[l]-h[l]-S,0),b[u]=x[u],d.setClipPath(new Z({shape:b})),d.__rectSize=b[l]}else p.eachChild(function(_){_.attr({invisible:!0,silent:!0})});var C=this._getPageInfo(e);return C.pageIndex!=null&&Oe(s,{x:C.contentPosition[0],y:C.contentPosition[1]},c?e:null),this._updatePageInfoView(e,C),x},r.prototype._pageGo=function(e,t,o){var i=this._getPageInfo(t)[e];i!=null&&o.dispatchAction({type:"legendScroll",scrollDataIndex:i,legendId:t.id})},r.prototype._updatePageInfoView=function(e,t){var o=this._controllerGroup;L(["pagePrev","pageNext"],function(s){var d=s+"DataIndex",p=t[d]!=null,g=o.childOfName(s);g&&(g.setStyle("fill",p?e.get("pageIconColor",!0):e.get("pageIconInactiveColor",!0)),g.cursor=p?"pointer":"default")});var i=o.childOfName("pageText"),l=e.get("pageFormatter"),u=t.pageIndex,v=u!=null?u+1:0,a=t.pageCount;i&&l&&i.setStyle("text",W(l)?l.replace("{current}",v==null?"":v+"").replace("{total}",a==null?"":a+""):l({current:v,total:a}))},r.prototype._getPageInfo=function(e){var t=e.get("scrollDataIndex",!0),o=this.getContentGroup(),i=this._containerGroup.__rectSize,l=e.getOrient().index,u=F[l],v=H[l],a=this._findTargetItemIndex(t),s=o.children(),d=s[a],p=s.length,g=p?1:0,h={contentPosition:[o.x,o.y],pageCount:g,pageIndex:g-1,pagePrevDataIndex:null,pageNextDataIndex:null};if(!d)return h;var c=G(d);h.contentPosition[l]=-c.s;for(var m=a+1,f=c,y=c,S=null;m<=p;++m)S=G(s[m]),(!S&&y.e>f.s+i||S&&!x(S,f.s))&&(y.i>f.i?f=y:f=S,f&&(h.pageNextDataIndex==null&&(h.pageNextDataIndex=f.i),++h.pageCount)),y=S;for(var m=a-1,f=c,y=c,S=null;m>=-1;--m)S=G(s[m]),(!S||!x(y,S.s))&&f.i<y.i&&(y=f,h.pagePrevDataIndex==null&&(h.pagePrevDataIndex=f.i),++h.pageCount,++h.pageIndex),f=S;return h;function G(b){if(b){var C=b.getBoundingRect(),_=C[v]+b[v];return{s:_,e:_+C[u],i:b.__legendDataIndex}}}function x(b,C){return b.e>=C&&b.s<=C+i}},r.prototype._findTargetItemIndex=function(e){if(!this._showController)return 0;var t,o=this.getContentGroup(),i;return o.eachChild(function(l,u){var v=l.__legendDataIndex;i==null&&v!=null&&(i=u),v===e&&(t=u)}),t!=null?t:i},r.type="legend.scroll",r}(ie);const Ke=Ee;function Ue(n){n.registerAction("legendScroll","legendscroll",function(r,e){var t=r.scrollDataIndex;t!=null&&e.eachComponent({mainType:"legend",subType:"scroll",query:r},function(o){o.setScrollDataIndex(t)})})}function Ze(n){N(ae),n.registerComponentModel($e),n.registerComponentView(Ke),Ue(n)}function Xe(n){N(ae),N(Ze)}export{Xe as i};
